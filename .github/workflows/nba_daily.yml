name: NBA_Daily_AI_Automation

on:
  schedule:
    # ë§¤ì¼ ì•„ì¹¨ í•œêµ­ ì‹œê°„(KST) ê¸°ì¤€ ì•½ 7ì‹œ (UTC 22:00)
    - cron: '0 22 * * *'
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # 1ï¸âƒ£ ì €ì¥ì†Œ ì½”ë“œ ì²´í¬ì•„ì›ƒ
      - name: Checkout code
        uses: actions/checkout@v3

      # 2ï¸âƒ£ Python í™˜ê²½ ì„¤ì •
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      # 3ï¸âƒ£ í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ (ğŸ”¥ bs4 í¬í•¨)
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install \
            pandas \
            numpy \
            requests \
            beautifulsoup4 \
            nba_api \
            python-dateutil \
            scikit-learn \
            xgboost

      # 4ï¸âƒ£ ë°ì´í„° ìˆ˜ì§‘ + AI ì˜ˆì¸¡ ì‹¤í–‰
      - name: Run NBA AI System
        env:
          DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
        run: |
          echo "ğŸš€ Starting Data Collection..."
          python crawl.py

          echo "ğŸ§  Starting AI Prediction..."
          python predict.py

      # 5ï¸âƒ£ (ì„ íƒ) ê²°ê³¼ CSV ìë™ ì»¤ë°‹
      # - name: Commit and push changes
      #   run: |
      #     git config --global user.name 'github-actions'
      #     git config --global user.email 'github-actions@github.com'
      #     git add nba_history_3years.csv nba_news.csv
      #     git commit -m "Daily NBA data update" || echo "No changes to commit"
      #     git push
