name: NBA_Daily_AI_Automation

on:
  schedule:
    # ë§¤ì¼ ì•„ì¹¨ í•œêµ­ ì‹œê°„(KST) ê¸°ì¤€ ì•½ 7ì‹œ~8ì‹œ ì‚¬ì´ì— ì‹¤í–‰ (UTC 22:00)
    - cron: '0 22 * * *'
  workflow_dispatch: # ìˆ˜ë™ìœ¼ë¡œ ì¦‰ì‹œ ì‹¤í–‰ ë²„íŠ¼ í™œì„±í™”

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # 1. ì €ì¥ì†Œì˜ ì½”ë“œë¥¼ ì„œë²„ë¡œ ê°€ì ¸ì˜´
      - name: Checkout code
        uses: actions/checkout@v3

      # 2. íŒŒì´ì¬ í™˜ê²½ ì„¤ì • (3.10 ë²„ì „ ê¶Œì¥)
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      # 3. í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ (scikit-learn ëˆ„ë½ í•´ê²°)
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install pandas numpy xgboost scikit-learn requests nba_api python-dateutil

      # 4. ë°ì´í„° ìˆ˜ì§‘ ë° ë¶„ì„ ì‹œìŠ¤í…œ ì‹¤í–‰
      - name: Run NBA AI System
        env:
          # GitHub Secretsì— ë“±ë¡í•œ ì›¹í›… ì£¼ì†Œë¥¼ íŒŒì´ì¬ í™˜ê²½ë³€ìˆ˜ë¡œ ì—°ê²°
          DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
        run: |
          echo "ğŸš€ Starting Data Collection..."
          python crawl.py
          
          echo "ğŸ§  Starting AI Prediction..."
          python predict.py

      # 5. (ì„ íƒì‚¬í•­) ìƒì„±ëœ ë°ì´í„° íŒŒì¼ì„ ì €ì¥ì†Œì— ë°±ì—… (í•„ìš”í•œ ê²½ìš°ë§Œ)
      # - name: Commit and push changes
      #   run: |
          # git config --global user.name 'github-actions'
          # git config --global user.email 'github-actions@github.com'
          # git add nba_history_3years.csv
          # git commit -m "Update NBA Data" || echo "No changes to commit"
          # git push
